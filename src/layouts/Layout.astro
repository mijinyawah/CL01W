---
import ControlPanel from '../components/ControlPanel.astro';

interface Props {}

const {} = Astro.props;
---

<div class="base-layout">
	<main class="base-layout__main">
		<aside class="sidebar">
			<input type="checkbox" id="nav-toggle" class="sidebar__toggle" aria-hidden="true" />
			<div class="sidebar__header">
				<p class="sidebar__tagline">
					A human and an AI named Claude built this website as an experiment.
				</p>
				<label for="nav-toggle" class="sidebar__menu-btn" aria-label="Toggle menu">
					<span class="sidebar__menu-btn-icon"></span>
				</label>
			</div>
			<p class="sidebar__about">
				I'm a brand and mograph designer who likes to experiment with new mediums.
			</p>
			<hr class="sidebar__divider" />
			<nav class="sidebar__nav" aria-label="Main">
				<a href="/">Home</a>
				<a href="/projects/">Projects</a>
			</nav>
			<hr class="sidebar__divider" />
			<div class="sidebar__connect">
				<a href="#" class="sidebar__icon-link" title="Portfolio" aria-label="Portfolio">
					<svg class="sidebar__icon" width="18" height="18" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><rect x="2" y="4" width="12" height="10" /><rect x="4" y="2" width="8" height="2" /><rect x="6" y="6" width="2" height="4" /><rect x="8" y="6" width="2" height="4" /></svg>
				</a>
				<a href="#" class="sidebar__icon-link" title="Bluesky" aria-label="Bluesky">
					<svg class="sidebar__icon" width="18" height="18" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 2v2H4v2h2v2H2v2h4v2h4v-2h2v-2H8V6h4V4H8V2z" /></svg>
				</a>
			</div>
			<a href="javascript:void(0)" class="sidebar__control-link" id="control-panel-toggle" data-control-panel>Control panel</a>
			<p class="sidebar__copyright">©2026 Hafsah Mijinyawa</p>
		</aside>
		<div class="content">
			<div class="content__inner">
				<slot />
			</div>
		</div>
	</main>
	<ControlPanel />
	<footer class="footer">
		©2026 Hafsah Mijinyawa
	</footer>
</div>

<style>
	.base-layout {
		height: 100vh;
		min-height: 0;
		width: 100%;
		padding: 0 var(--page-padding);
		display: flex;
		flex-direction: column;
		overflow: hidden;
	}

	.base-layout__main {
		display: flex;
		width: 100%;
		min-width: 0;
		gap: 0;
		padding-top: var(--page-padding);
		flex: 1;
		min-height: 0;
		/* Fixed app shell: main row fills remaining viewport */
		height: 0;
	}

	/* Sidebar — fluid width, content scales to fit (no scroll, no clip) */
	.sidebar {
		flex: 0 0 30%;
		min-width: 260px;
		max-width: 352px;
		align-self: stretch;
		min-height: 0;
		background: var(--sidebar-bg);
		border-radius: var(--radius-container);
		padding: 20px;
		display: flex;
		flex-direction: column;
		gap: clamp(12px, 2vh, 24px);
		overflow: visible;
	}

	.sidebar__toggle {
		position: absolute;
		opacity: 0;
		pointer-events: none;
	}

	.sidebar__header {
		display: block;
	}

	.sidebar__menu-btn {
		display: none;
	}

	.sidebar__tagline {
		font-family: var(--font-sidebar);
		font-weight: 700;
		font-size: clamp(16px, 2vw, 22px);
		line-height: 1.3;
		color: var(--sidebar-text);
		margin: 0;
		max-width: 100%;
	}

	.sidebar__about {
		font-family: var(--font-sidebar);
		font-weight: 400;
		font-size: 14px;
		line-height: 22px;
		color: var(--sidebar-text);
		margin: 0;
		max-width: 100%;
	}

	.sidebar__divider {
		width: 100%;
		max-width: 300px;
		height: 1px;
		margin: 0;
		border: none;
		background: var(--sidebar-divider);
	}

	.sidebar__nav,
	.sidebar__connect {
		display: flex;
		flex-direction: column;
		gap: clamp(8px, 1.5vh, 16px);
	}

	.sidebar__nav a,
	.sidebar__connect a {
		font-family: var(--font-sidebar);
		font-weight: 500;
		font-size: 14px;
		line-height: 24px;
		color: var(--sidebar-nav);
		text-decoration: none;
	}

	.sidebar__nav a:hover,
	.sidebar__connect a:hover {
		text-decoration: underline;
	}

	.sidebar__icon-link {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		color: var(--sidebar-nav);
		text-decoration: none;
		transition: color 0.15s ease;
	}

	.sidebar__icon-link:hover {
		color: var(--cursor-trail);
	}

	.sidebar__icon {
		display: block;
	}

	.sidebar__control-link {
		display: inline-block;
		font-family: var(--font-sidebar);
		font-weight: 500;
		font-size: 13px;
		line-height: 24px;
		color: #0d1316;
		background: #2dd4a0;
		padding: 8px 16px;
		text-decoration: none;
		transition: background 0.15s ease, color 0.15s ease;
	}

	.sidebar__control-link:hover {
		background: #0d1316;
		color: #2dd4a0;
		text-decoration: none;
	}

	.sidebar__copyright {
		margin: 0;
		margin-top: auto;
		padding-top: 16px;
		font-family: var(--font-body);
		font-weight: 400;
		font-size: 13px;
		line-height: 1.5;
		color: rgba(0, 0, 0, 0.4);
	}

	.footer--desktop-hidden {
		display: none;
	}

	/* Content area — takes remaining space, independent scrollbox */
	.content {
		position: relative;
		flex: 1;
		min-width: 0;
		min-height: 0;
		background: var(--content-bg);
		border-radius: var(--radius-container);
		padding: var(--page-padding);
		overflow-y: auto;
		scroll-behavior: smooth;
	}

	/* Minimal dark scrollbar for content area */
	.content::-webkit-scrollbar {
		width: 6px;
	}

	.content::-webkit-scrollbar-track {
		background: rgba(0, 0, 0, 0.2);
		border-radius: 3px;
	}

	.content::-webkit-scrollbar-thumb {
		background: rgba(0, 0, 0, 0.4);
		border-radius: 3px;
	}

	.content::-webkit-scrollbar-thumb:hover {
		background: rgba(0, 0, 0, 0.5);
	}

	.content__inner {
		position: relative;
		z-index: 1;
		padding: 0;
	}

	/* Footer — visible on mobile only */
	.footer {
		flex-shrink: 0;
		padding: 50px 50px 40px;
		font-family: var(--font-body);
		font-weight: 400;
		font-size: 15px;
		line-height: 1.6;
		color: rgba(0, 0, 0, 0.4);
	}

	@media (min-width: 801px) {
		.footer {
			display: none;
		}
	}

	/* ---------- Stacked / mobile (<800px) — hamburger menu, page scroll ---------- */
	@media (max-width: 800px) {
		.base-layout {
			height: auto;
			min-height: 100vh;
			overflow: visible;
			padding: 0 16px;
		}

		.base-layout__main {
			flex: 1 1 auto;
			height: auto;
			flex-direction: column;
			padding-top: 24px;
			min-height: 0;
		}

		.sidebar {
			flex: none;
			min-width: 0;
			max-width: none;
			width: 100%;
			flex-direction: column;
			align-items: stretch;
			padding: 16px;
			overflow: visible;
			gap: 12px;
			background-color: transparent;
		}

		.sidebar__header {
			background-color: transparent;
		}

		/* Header row: tagline left, hamburger right (top-aligned) */
		.sidebar__header {
			display: flex;
			align-items: flex-start;
			justify-content: space-between;
			gap: 16px;
		}

		.sidebar__tagline {
			font-size: clamp(30px, 5vw, 32px);
			line-height: 1.2;
			max-width: 100%;
			flex: 1;
			min-width: 0;
		}

		/* Hamburger button visible on stacked */
		.sidebar__menu-btn {
			display: flex;
			align-items: center;
			justify-content: center;
			flex-shrink: 0;
			align-self: flex-start;
			width: 44px;
			height: 44px;
			cursor: pointer;
			color: var(--sidebar-text);
			background: transparent;
			border: none;
		}

		.sidebar__menu-btn-icon {
			display: block;
			width: 24px;
			height: 2px;
			background: currentColor;
			box-shadow: 0 6px 0 currentColor, 0 12px 0 currentColor;
		}

		.sidebar__copyright {
			display: none;
		}

		/* Collapsed by default: hide about, dividers, nav, connect */
		.sidebar__about,
		.sidebar__divider,
		.sidebar__nav,
		.sidebar__connect {
			display: none;
		}

		.sidebar__control-link {
			display: none !important;
		}

		/* Expanded when menu is open */
		.sidebar:has(.sidebar__toggle:checked) .sidebar__about,
		.sidebar:has(.sidebar__toggle:checked) .sidebar__divider,
		.sidebar:has(.sidebar__toggle:checked) .sidebar__nav,
		.sidebar:has(.sidebar__toggle:checked) .sidebar__connect {
			display: flex;
			flex-direction: row;
			gap: 12px;
		}

		.sidebar:has(.sidebar__toggle:checked) .sidebar__divider {
			display: block;
			width: 100%;
		}

		.sidebar__nav {
			flex-direction: column;
			gap: 8px;
		}

		.sidebar__connect {
			flex-direction: column;
			gap: 8px;
		}

		/* Content area: full width, visible below header without closing menu */
		.content {
			width: 100%;
			max-width: none;
			min-height: 60vh;
			flex: 1 1 auto;
			overflow: visible;
			padding: 24px;
		}

		/* Tighter line-height on stacked */
		.content :global(p),
		.content :global(li) {
			line-height: 1.4;
		}

		.content__inner {
			padding: 0;
		}

		.footer {
			padding: 24px 16px 32px;
		}
	}

	/* Article titles scale (used by content inside slot) */
	@media (max-width: 800px) {
		.content :global(h1),
		.content :global(.article-title) {
			font-size: 32px;
		}
	}
</style>
