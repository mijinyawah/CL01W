---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).filter((p) => !p.data.draft);
---

<BaseLayout title="Projects">
	<Layout>
		<div class="projects-page">
			<header class="projects-header">
				<h1 class="projects-title">Projects</h1>
				<div class="projects-byline">
					<span class="projects-byline__name">Hafsah M</span>
					<span class="projects-byline__role">User</span>
				</div>
			</header>

			<div class="projects-grid">
				{projects.map((entry) => {
					const href = entry.data.linkedArticle
						? `/articles/${entry.data.linkedArticle}/`
						: undefined;
					return (
						href ? (
							<a class="project-card" href={href}>
								<span class="project-card__tag">{entry.slug}</span>
								<h2 class="project-card__title">{entry.data.title}</h2>
								<p class="project-card__description">{entry.data.description}</p>
								<div class="project-card__tags">
									{entry.data.tags.map((tag) => (
										<span class="project-card__pill">{tag}</span>
									))}
								</div>
							</a>
						) : (
							<div class="project-card">
								<span class="project-card__tag">{entry.slug}</span>
								<h2 class="project-card__title">{entry.data.title}</h2>
								<p class="project-card__description">{entry.data.description}</p>
								<div class="project-card__tags">
									{entry.data.tags.map((tag) => (
										<span class="project-card__pill">{tag}</span>
									))}
								</div>
							</div>
						)
					);
				})}
			</div>
		</div>
	</Layout>
</BaseLayout>

<style>
	.projects-page {
		padding: 25px 0 40px;
	}

	.projects-header {
		margin-bottom: 32px;
		padding: 0 50px;
	}

	.projects-title {
		font-family: var(--font-pixel);
		font-size: 48px;
		line-height: 52px;
		color: var(--content-title);
		margin: 0 0 16px;
	}

	.projects-byline {
		display: flex;
		flex-direction: column;
		gap: 0;
	}

	.projects-byline__name {
		font-family: var(--font-body);
		font-size: 13px;
		line-height: 1.23;
		color: var(--meta-text);
	}

	.projects-byline__role {
		font-family: var(--font-body);
		font-size: 13px;
		line-height: 1.23;
		color: var(--content-body);
	}

	.projects-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 21px;
		max-width: var(--content-max);
		margin: 0 50px;
	}

	.project-card {
		display: flex;
		flex-direction: column;
		align-items: flex-start;
		background: var(--codeblock-bg);
		border-radius: var(--radius-container);
		padding: 22px;
		min-height: 300px;
		text-decoration: none;
		color: inherit;
	}

	.project-card:hover {
		outline: 1px solid var(--meta-border);
	}

	.project-card__tag {
		font-family: var(--font-body);
		font-size: 12px;
		color: var(--content-caption);
		margin-bottom: 8px;
	}

	.project-card__title {
		font-family: var(--font-body);
		font-weight: 500;
		font-size: 18px;
		color: var(--content-heading);
		margin: 0 0 12px;
	}

	.project-card__description {
		font-family: var(--font-body);
		font-size: 15px;
		line-height: 1.5;
		color: var(--content-body);
		margin: 0 0 16px;
		flex-grow: 1;
	}

	.project-card__tags {
		display: flex;
		flex-wrap: wrap;
		gap: 8px;
	}

	.project-card__pill {
		font-family: var(--font-body);
		font-weight: 700;
		font-size: 11px;
		line-height: 1.82;
		text-transform: uppercase;
		color: var(--meta-text);
		border: 0.5px solid var(--meta-border);
		padding: 0 8px;
	}

	/* Single column when content area is narrow (~900px viewport with sidebar) */
	@media (max-width: 900px) {
		.projects-grid {
			grid-template-columns: 1fr;
			margin: 0;
		}
	}

	@media (max-width: 800px) {
		.projects-grid {
			grid-template-columns: 1fr;
			margin: 0;
		}
	}
</style>
